var XD=function(){var a,b,c=1,d,e=this;return{serialize:function(c){var a="",b=!0,d;for(d in c)b||(a+="&"),b=!1,a+=encodeURIComponent(d)+"="+encodeURIComponent(c[d]);return a},deserialize:function(a){for(var c={},a=a.split("&"),b=0;b<a.length;b++){var d=a[b].split("=");c[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return c},postMessage:function(a,b,d){if(b&&(d=d||parent))if(e.postMessage)d.postMessage(a,b.replace(/([^:]+:\/\/[^\/]+).*/,"$1"));else if(b)d.location=b.replace(/#.*$/,"")+"#"+ +new Date+
c++ +"&"+a},receiveMessage:function(c,f){if(e.postMessage)if(c&&(d=function(a){if("string"===typeof f&&a.origin!==f||"[object Function]"===Object.prototype.toString.call(f)&&!1===f(a.origin))return!1;c(a)}),e.addEventListener)e[c?"addEventListener":"removeEventListener"]("message",d,!1);else e[c?"attachEvent":"detachEvent"]("onmessage",d);else a&&clearInterval(a),a=null,c&&(a=setInterval(function(){var a=document.location.hash,d=/^#?\d+&/;a!==b&&d.test(a)&&(b=a,c({data:a.replace(d,"")}))},100))}}}(),
IFRAME_AT_PUBL_COM="";XD.receiveMessage(function(a){a=XD.deserialize(a.data);if("publ"==a.from)IFRAME_AT_PUBL_COM=a.url},function(){return!0});PUBL=!1;
var browser={name:"",prefix:"",isIE:!1,versionIE:"",supportHTML5:!0,isFlash:!1,detect:function(){browser.checkFlash();var a=navigator.userAgent.toLowerCase().match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0];browser.name="version"==a[1]?a[3]:a[1];switch(browser.name){case "safari":browser.prefix="Webkit";break;case "firefox":browser.prefix="Moz";break;case "opera":browser.prefix="O";break;case "ie":browser.prefix="ms";browser.isIE=
!0;if(document.all&&!document.querySelector)browser.supportHTML5=!1,browser.versionIE=7;if(document.all&&document.querySelector&&!document.getElementsByClassName)browser.supportHTML5=!1,browser.versionIE=8;if(document.all&&document.querySelector&&document.getElementsByClassName&&!window.atob)browser.versionIE=9;if(document.all&&document.querySelector&&document.getElementsByClassName&&window.atob)browser.versionIE=10,browser.prefix="ms";break;case "chrome":browser.prefix="Webkit";break;case "unknown":browser.prefix=
"webkit"}},checkFlash:function(){var a=0,b=null;if("undefined"!=typeof navigator.plugins&&"object"==typeof navigator.plugins["Shockwave Flash"]){if((b=navigator.plugins["Shockwave Flash"].description)&&!("undefined"!=typeof navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]&&!navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin))b=b.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a=parseInt(b.replace(/^(.*)\..*$/,"$1"),10)}else if("undefined"!=typeof window.ActiveXObject)try{var c=
new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(c&&(b=c.GetVariable("$version")))b=b.split(" ")[1].split(","),a=parseInt(b[0],10)}catch(d){}if(0!=a)browser.isFlash=!0}},workspace={w:1200,h:800,listeners:[],addListener:function(a){workspace.listeners.push(a)},getSize:function(){browser.supportHTML5?(workspace.w=window.innerWidth?window.innerWidth:workspace.w,workspace.h=window.innerHeight?window.innerHeight:workspace.h):(workspace.w=document.documentElement.clientWidth?document.documentElement.clientWidth:
workspace.w,workspace.h=document.documentElement.clientHeight?document.documentElement.clientHeight:workspace.h)},callFn:function(){for(var a=0;a<workspace.listeners.length;a++)workspace.listeners[a].call(this)}},blackBG={listeners:[],create:function(a){var a=a||!1,b=document.createElement("div");b.id="blackBG";b.style.width=workspace.w+"px";b.style.height=workspace.h+"px";b.style.position="fixed";b.style.top="0px";b.style.left="0px";b.style.display="block";b.style.zIndex="1000000";browser.supportHTML5?
b.style.backgroundColor="rgba(0,0,0,0.7)":b.style.background="url('./style/bg_opacity.png')";setEvent(b,"click",blackBG.remove);if(a)a=document.createElement("div"),a.className="closeBG",b.appendChild(a);workspace.addListener(blackBG.resize);document.getElementById("bodyBg").parentNode.appendChild(b)},addListener:function(a){this.listeners.push(a)},remove:function(a){var b=document.getElementById("blackBG");b.parentNode.removeChild(b);for(b=0;b<blackBG.listeners.length;b++)blackBG.listeners[b].call(this);
a.preventDefault?a.preventDefault():a.returnValue=!1;a.stopPropagation?a.stopPropagation():a.returnValue=!1},resize:function(){if(document.getElementById("blackBG")){var a=document.getElementById("blackBG");a.style.width=workspace.w+"px";a.style.height=workspace.h+"px"}}},notification={noFlash:!1,show:function(){if(-1!=window.location.hash.indexOf("noFlash")){notification.noFlash=!0;blackBG.create();var a="",a=""!=PublicationTypeUrl?'<a id="pblType" href="'+PublicationTypeUrl+'" style="text-decoration: none; color: black;">'+
LOCALS[PublicationTypeName.toUpperCase()]+"</a>":LOCALS[PublicationTypeName.toUpperCase()],b=document.getElementById("blackBG");b.innerHTML='<div id="flash-notification" style="width:600px; min-height:200px;  margin: auto; position: relative; top: 30%; padding: 18px; overflow: hidden; background-color: rgb(255, 255, 255); border: 1px solid rgb(200, 200, 200); border-radius: 7px; font-style: normal; font-variant: normal; font-weight: normal; font-size: 12px; line-height: 14px; font-family: Arial; position: relative; background-position: initial initial; background-repeat: initial initial; -webkit-box-shadow: 0px 3px 10px rgba(0,0,0,.8);-moz-box-shadow: 0px 3px 10px rgba(0,0,0,.8); box-shadow: 0px 3px 10px rgba(0,0,0,.8);"><a id="closeButton" href="javascript:void();" style="display:block;width:30px;height:30px;text-decoration:none;font:0/0 a;cursor:pointer;background:url(style/close.png);position:absolute;top:5px;right:5px;left:auto;bottom:auto;"></a><div style="display:block;cursor:pointer;min-width:50px;min-height:50px;display:block;float:left;text-decoration:none;margin:10px 28px 10px 10px; "><img id="noteImage" onload="notification.animated(this);"  style="-webkit-box-shadow: 0px 3px 10px rgba(0,0,0,.5);-moz-box-shadow: 0px 3px 10px rgba(0,0,0,.5); box-shadow: 0px 3px 10px rgba(0,0,0,.5);" src="'+
COVER_SRC+'"></div><div id="noteText" style="margin-left: 128px;"><h3 style="font-weight:bold;padding: 14px 10px 10px 10px; font-size:18px; margin-right: 20px;line-height: 22px;">'+TITLE+'</h3><div style="padding: 10px;">'+LOCALS.NOTIFICATION_TEXT.replace("{0}",a)+'</div><a id="getFlash" href="http://get.adobe.com/flashplayer/" style="display:block;text-decoration:none;margin:15px 10px 0 10px;" target="_blank"><img src="http://www.adobe.com/macromedia/style_guide/images/160x41_Get_Flash_Player.jpg" alt="" border="0" style="border:0;display:block;" width="160" height="41"></a></div></div>';
browser.supportHTML5?b.addEventListener("DOMContentLoaded",notification.eventFn(),!1):b.attachEvent("onDOMContentLoaded",notification.eventFn)}},eventFn:function(){var a=document.getElementById("flash-notification");setEvent(a,"click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;a.stopPropagation?a.stopPropagation():a.returnValue=!1});setEvent(a.childNodes[0],"click",function(a){blackBG.remove(a);a.preventDefault?a.preventDefault():a.returnValue=!1;a.stopPropagation?a.stopPropagation():
a.returnValue=!1});var b=function(a){window.location.replace(FULL_SRC);a.preventDefault?a.preventDefault():a.returnValue=!1;a.stopPropagation?a.stopPropagation():a.returnValue=!1};a.getElementsByTagName("img")&&setEvent(a.getElementsByTagName("img")[0].parentNode,"click",b);a=function(a){window.open(PublicationTypeUrl);a.preventDefault?a.preventDefault():a.returnValue=!1;a.stopPropagation?a.stopPropagation():a.returnValue=!1};document.getElementById("pblType")&&setEvent(document.getElementById("pblType"),
"click",a);a=document.getElementById("getFlash");setEvent(a.childNodes[0],"click",function(a){window.open("http://get.adobe.com/flashplayer/","","");a.preventDefault?a.preventDefault():a.returnValue=!1;a.stopPropagation?a.stopPropagation():a.returnValue=!1})},animated:function(a){a=a.parentNode.parentNode;a.childNodes[2].style.marginLeft=a.childNodes[1].offsetWidth+28+"px";a.childNodes[1].innerHTML='<iframe id="sprateIframe" style="-webkit-box-shadow: 0px 3px 10px rgba(0,0,0,.5);-moz-box-shadow: 0px 3px 10px rgba(0,0,0,.5); box-shadow: 0px 3px 10px rgba(0,0,0,.5);" frameborder="0"  width="'+
a.childNodes[1].offsetWidth+'px" height="'+(a.childNodes[1].offsetHeight-3)+'px"  title='+TITLE+' src="'+SPREAD_SRC+'" type="text/html" scrolling="no" marginwidth="0" marginheight="0"></iframe>'}},video={play:function(a,b){blackBG.create();var c=document.createElement("div");c.id="videoPlayer";c.style.position="relative";c.style.margin="5% auto";c.style.minHeight="200px";c.style.minWidth="300px";c.style.maxHeight="85%";c.style.maxWidth="80%";c.style.width="85%";c.style.height="85%";c.style.backgroundColor=
"rgba(0,0,0,1)";document.getElementById("blackBG").appendChild(c);var d=document.createElement("iframe");c.appendChild(d);d.className="youtube-player";d.type="text/html";d.width="100%";d.height="100%";d.frameBorder="0";d.style.display="inline-block";if("YouTube"==a)d.className="youtube-player",d.src="http://www.youtube.com/embed/"+b+"?autoplay=1&html5=1";else if("Vimeo"==a)d.src="http://player.vimeo.com/video/"+b+"?title=0&amp;byline=0&amp;portrait=0&amp;color=da4541"}};BASIC_SRC="";
function initLinks(){var a="png"==COVER_SRC.split(".")[COVER_SRC.split(".").length-1]?"p":"j";if(-1!=document.domain.indexOf("publ.com")){for(var b=document.URL.split("/"),c="",d=0;d<b.length;d++){"bookdata"==c.toLowerCase()&&(PUBL=b[d]);if("seo"==b[d].toLowerCase()||"basic-html"==b[d].toLowerCase())PUBL=c;c=b[d]}BASIC_SRC=decodeURIComponent("http://"+document.domain+"/BookData/"+PUBL+"/basic-html");FULL_SRC=decodeURIComponent("http://"+document.domain+"/"+PUBL);SPREAD_SRC=decodeURIComponent("http://"+
document.domain+"/e/"+PUBL+"?p=1&a=o&f="+a+"&mode=spread&link="+FULL_SRC)}else{var b=window.location.pathname.split("/"),e=FULL_SRC.split("/"),c=window.location.hostname,c=-1!=b[1].indexOf(":")?(browser.name="firefox","file:///"+b[1]):"http://"+c+"/"+b[1];if(1<b.length)for(d=2;d<b.length-e.length;d++)c=c+"/"+b[d];FULL_SRC=decodeURIComponent(c+"/"+e[e.length-1]);if(1<b.length)for(d=b.length-e.length;d<b.length-1;d++)c=c+"/"+b[d];BASIC_SRC=decodeURIComponent(c);SPREAD_SRC=decodeURIComponent(SPREAD_SRC+
"?p=1&a=o&f="+a+"&link="+FULL_SRC)}}bgCorrection=function(){if(!browser.supportHTML5){var a=document.getElementById("bodyBg"),b=a.currentStyle||window.getComputedStyle(a,null);if("none"!=b.backgroundImage){var c=document.createElement("img");c.src=b.backgroundImage.substr(5,b.backgroundImage.length-7);c.style.position="fixed";c.style.top="0px";c.style.left="0px";c.style.width="100%";c.style.height="100%";a.appendChild(c);a.style.backgroundImage="none"}}};
setEvent=function(a,b,c){browser.supportHTML5?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c,!1)};
function init(){initLinks();browser.detect();workspace.getSize();workspace.addListener(workspace.getSize);browser.supportHTML5?window.addEventListener("resize",workspace.callFn,!1):window.location.pathname.indexOf("index.html")&&window.attachEvent("onresize",workspace.callFn);var a=document.getElementsByTagName("head")[0],b=document.createElement("script");b.id="formPrinter";b.type="text/javascript";b.src=LOCALS_FOLDER+"/"+LANG+"/textlang.js";a.appendChild(b)}
function bindReady(a){function b(){c||(c=!0,setTimeout(a,50))}var c=!1;if(document.addEventListener)document.addEventListener("DOMContentLoaded",function(){b()},!1);else if(document.attachEvent){if(document.documentElement.doScroll&&window==window.top){var d=function(){if(!c&&document.body)try{document.documentElement.doScroll("left"),b()}catch(a){setTimeout(d,0)}};d()}document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&b()})}window.addEventListener?window.addEventListener("load",
b,!1):window.attachEvent?window.attachEvent("onload",b):window.onload=b}bindReady(init);
